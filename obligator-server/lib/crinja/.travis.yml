dist: bionic
language: crystal

env:
  global:
    GIT_COMMITTER_NAME: travis-ci
    GIT_COMMITTER_EMAIL: travis@travis-ci.org

crystal:
- latest

jobs:
- stage: test
  name: unit tests
  script: make test/unit
- stage: test
  name: format
  script: make format CRYSTAL_OPTS=--check
- stage: test
  name: integration tests
  addons:
    apt:
      sources:
      - sourceline: 'ppa:duggan/bats'
      packages:
      - bats
  script: make test/integration
